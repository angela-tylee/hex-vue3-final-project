import{a as y,S as b}from"./sweetalert2.all-3NlZ93nL.js";import{M as V}from"./bootstrap.esm-TTjMTX3M.js";import{_ as x,m as S,a as M,r as k,o as a,c,b as t,d as p,w as v,t as s,F as A,i as E,f as l,g as u,k as $,l as w,e as P,j as T,p as q,h as B}from"./index-niEC8eyb.js";import{c as L}from"./cartStore-oMkksvUW.js";var R={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"angelalee",BASE_URL:"/hex-vue3-final-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:g,VITE_API_PATH:f}=R;let C="";const U={data(){return{coupon:{code:"",success:!1},status:{removeCartLoading:!1,couponLoading:!1}}},watch:{"$i18n.locale":{handler(){this.getCart()},deep:!0}},computed:{...S(L,["carts","cartQty","cartLength","storeStatus"])},methods:{...M(L,["getCart","changeCartQty","getCartQty"]),removeCartItem(e){y.delete(`${g}/api/${f}/cart/${e}`).then(()=>{this.getCart()}).catch(n=>{b.fire({title:n.response.data.message,confirmButtonColor:"var(--bs-danger)"})})},removeCartItemAll(){this.status.removeCartLoading=!0,y.delete(`${g}/api/${f}/carts`).then(()=>{b.fire({title:"已清空購物車！",icon:"success",confirmButtonColor:"var(--bs-primary)",iconColor:"var(--bs-primary)"}),C.hide(),this.status.removeCartLoading=!1,this.getCart()}).catch(e=>{this.status.removeCartLoading=!1,b.fire({title:e.response.data.message,confirmButtonColor:"var(--bs-danger)"})})},openModal(){C.show()},applyCoupon(e){const n={code:e};this.status.couponLoading=!0,y.post(`${g}/api/${f}/coupon`,{data:n}).then(h=>{this.status.couponLoading=!1,this.coupon.success=h.data.success}).catch(h=>{b.fire({title:h.response.data.message,confirmButtonColor:"var(--bs-danger)"}),this.status.couponLoading=!1})}},mounted(){this.getCart(),C=new V(document.getElementById("delProductModal"))}},i=e=>(q("data-v-4a876a8a"),e=e(),B(),e),Q={class:"container"},D={class:"stepper-container"},N={class:"stepper"},O={class:"step"},H=i(()=>t("div",{class:"step-circle bg-primary text-cus-cream"},"1",-1)),j={class:""},z={class:"step"},F=i(()=>t("div",{class:"step-circle active"},"2",-1)),W={class:"step"},G=i(()=>t("div",{class:"step-circle"},"3",-1)),J={class:"step"},K=i(()=>t("div",{class:"step-circle"},"4",-1)),X=i(()=>t("div",{class:"stepper-line"},null,-1)),Y={class:"grid"},Z={class:"grid-card shopping-cart bg-secondary-subtle"},tt={class:"table align-middle",style:{"--bs-table-bg":"transparent","--bs-table-color":"$primary"}},et={width:"15%",class:"text-center"},st=i(()=>t("th",{width:"30%",class:"text-center"},null,-1)),ot={width:"10%",class:"text-center"},at={width:"25%",class:"text-center"},ct={width:"15%",class:"text-end"},nt=i(()=>t("th",{width:"5%",class:"text-center"},null,-1)),dt={class:"table-img"},it=["src"],lt={class:"table-item"},rt={key:0},ut={key:1},pt={class:"table-price text-center"},ht={class:"table-qty text-center"},_t={class:"input-group"},mt=["onClick","disabled"],bt=["onUpdate:modelValue"],vt=["onClick"],yt={class:"table-final-price text-end"},gt={class:"table-delete-btn text-end",style:{"font-size":"1.5em"}},ft={type:"button",style:{border:"none","border-radius":"100%","background-color":"transparent"}},Ct=["onClick"],kt={key:0,class:"loading"},$t=i(()=>t("div",{class:"spinner-border text-primary",role:"status"},null,-1)),wt=[$t],Lt={key:1,class:"text-center mt-5 cart-empty"},It=i(()=>t("br",null,null,-1)),Vt=["disabled"],xt={key:0,class:"spinner-border text-cus-cream",style:{width:"1.2em",height:"1.2em"},role:"status"},St={class:"grid-card order-summary bg-primary"},Mt={class:"order-summary-content"},At={class:"text-cus-cream"},Et={class:"row row-cols-2"},Pt={class:"col-8 mt-4 text-cus-cream"},Tt={class:"col-4 mt-4 text-cus-cream text-end"},qt={class:"col-6 mt-4 text-cus-cream"},Bt={class:"col-6 mt-4 text-cus-cream text-end"},Rt={class:"col-12 mt-4 text-cus-cream"},Ut={class:"col-12 mt-2 text-cus-cream input-group"},Qt=["disabled"],Dt={key:0,class:"spinner-border text-cus-cream",style:{width:"1.2em",height:"1.2em"},role:"status"},Nt={class:"col-12 mt-4"},Ot={key:0,class:"text-cus-cream"},Ht={class:"col-6 mt-4 text-cus-cream fs-5 fw-semibold"},jt={class:"col-6 mt-4 text-end fs-5 fw-semibold"},zt={key:0,class:"text-cus-cream"},Ft={key:1,class:"text-cus-cream"},Wt={class:"col-12 mt-4"},Gt=["disabled"],Jt={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Kt={class:"modal-dialog"},Xt={class:"modal-content border-0"},Yt=T('<div class="modal-header bg-primary text-white" data-v-4a876a8a><h5 id="delProductModalLabel" class="modal-title" data-v-4a876a8a><span class="text-white" data-v-4a876a8a>清空購物車</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" data-v-4a876a8a></button></div><div class="modal-body" data-v-4a876a8a> 是否清空購物車 </div>',2),Zt={class:"modal-footer"},te=i(()=>t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1));function ee(e,n,h,se,d,r){const _=k("RouterLink"),I=k("RouterView");return a(),c("div",Q,[t("div",D,[t("div",N,[t("div",O,[p(_,{to:"/products"},{default:v(()=>[H]),_:1}),t("span",j,s(e.$t("stepper.shopping")),1)]),t("div",z,[F,t("span",null,s(e.$t("stepper.cart")),1)]),t("div",W,[G,t("span",null,s(e.$t("stepper.checkout")),1)]),t("div",J,[K,t("span",null,s(e.$t("stepper.confirm")),1)])]),X]),t("div",Y,[t("div",Z,[t("h2",null,s(e.$t("cart.shopping-cart")),1),t("table",tt,[t("thead",null,[t("tr",null,[t("th",et,s(e.$t("cart.item")),1),st,t("th",ot,s(e.$t("cart.price")),1),t("th",at,s(e.$t("cart.quantity")),1),t("th",ct,s(e.$t("cart.total")),1),nt])]),t("tbody",null,[(a(!0),c(A,null,E(e.carts.carts,o=>(a(),c("tr",{key:o.id},[t("td",dt,[t("img",{src:o.product.imageUrl,alt:"product-img",style:{width:"100%"}},null,8,it)]),t("td",lt,[p(_,{to:`/product/${o.product.id}`},{default:v(()=>[e.$i18n.locale==="zh-TW"?(a(),c("span",rt,s(o.product.title),1)):l("",!0),e.$i18n.locale==="en"?(a(),c("span",ut,s(o.product.en.title),1)):l("",!0)]),_:2},1032,["to"])]),t("td",pt,"$"+s(o.product.price),1),t("td",ht,[t("div",_t,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:m=>{o.qty--,e.changeCartQty(o,o.qty)},disabled:o.qty===1}," - ",8,mt),$(t("input",{type:"text",class:"form-control text-center","onUpdate:modelValue":m=>o.qty=m,readonly:""},null,8,bt),[[w,o.qty]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:m=>{o.qty++,e.changeCartQty(o,o.qty)}}," + ",8,vt)])]),t("td",yt,[t("span",null,"$"+s(o.total),1)]),t("td",gt,[t("button",ft,[t("i",{class:"bi bi-x",onClick:m=>r.removeCartItem(o.id)},null,8,Ct)])])]))),128))])]),e.storeStatus.cartLoading?(a(),c("div",kt,wt)):l("",!0),e.cartLength===0?(a(),c("p",Lt,[u(s(e.$t("cart.cart-empty"))+" ",1),It,p(_,{to:"/products"},{default:v(()=>[u(s(e.$t("cart.continue-shopping"))+" >>",1)]),_:1})])):l("",!0),e.cartLength!==0?(a(),c("button",{key:2,type:"button",class:"btn btn-primary text-cus-cream",onClick:n[0]||(n[0]=(...o)=>r.openModal&&r.openModal(...o)),disabled:d.status.removeCartLoading},[d.status.removeCartLoading?(a(),c("i",xt)):l("",!0),u(" "+s(e.$t("cart.remove-cart-all")),1)],8,Vt)):l("",!0)]),t("div",St,[t("div",Mt,[t("h2",At,s(e.$t("cart.order-summary")),1),t("div",Et,[t("div",Pt,s(e.$t("cart.total-qty"))+":",1),t("div",Tt,s(e.cartQty),1),t("div",qt,s(e.$t("cart.subtotal"))+":",1),t("div",Bt,"$ "+s(e.carts.total),1),t("div",Rt,s(e.$t("cart.discount"))+": ",1),t("div",Ut,[$(t("input",{type:"text",class:"form-control",placeholder:"Enter SWEETTOOTH2024","aria-describedby":"button-addon2","onUpdate:modelValue":n[1]||(n[1]=o=>d.coupon.code=o)},null,512),[[w,d.coupon.code]]),t("button",{class:"btn btn-secondary text-cus-cream",type:"button",id:"button-addon2",onClick:n[2]||(n[2]=P(o=>r.applyCoupon(d.coupon.code),["prevent"])),disabled:d.status.couponLoading||d.coupon.code===""},[d.status.couponLoading?(a(),c("i",Dt)):l("",!0),u(" "+s(e.$t("cart.apply-discount")),1)],8,Qt)]),t("div",Nt,[d.coupon.success?(a(),c("p",Ot,s(e.$t("cart.coupon-applied")),1)):l("",!0)]),t("div",Ht,s(e.$t("cart.final-total"))+": ",1),t("div",jt,[d.coupon.success?(a(),c("span",zt,"$ "+s(e.carts.final_total),1)):(a(),c("span",Ft,"$ "+s(e.carts.total),1))])])]),t("div",Wt,[t("button",{type:"button",class:"checkout-button btn btn-cus-cream text-primary",disabled:e.cartLength===0},[p(_,{to:"/checkout"},{default:v(()=>[u(s(e.$t("cart.checkout")),1)]),_:1})],8,Gt)])])]),t("div",Jt,[t("div",Kt,[t("div",Xt,[Yt,t("div",Zt,[te,t("button",{type:"button",class:"btn btn-primary",onClick:n[3]||(n[3]=(...o)=>r.removeCartItemAll&&r.removeCartItemAll(...o))}," 確認清空 ")])])]),u("- ")],512),p(I)])}const de=x(U,[["render",ee],["__scopeId","data-v-4a876a8a"]]);export{de as default};
