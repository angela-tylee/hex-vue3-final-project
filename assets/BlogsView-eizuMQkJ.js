import{a as b,S as r}from"./sweetalert2.all-3NlZ93nL.js";import{M as g}from"./bootstrap.esm-TTjMTX3M.js";import{_ as C,r as M,o as c,c as m,b as t,F as y,i as V,f as k,g as p,t as _,k as n,l as a,Q as A,d as T}from"./index-r2JnNlAo.js";var P={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"angelalee",BASE_URL:"/hex-vue3-final-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:u,VITE_API_PATH:h}=P;let f="",v="";const B={data(){return{blogs:[],temp:{},enTemp:{},isNew:!1,status:{listLoading:!1}}},methods:{getArticles(){this.status.listLoading=!0;const l=`${u}/api/${h}/admin/articles`;b.get(l).then(e=>{this.blogs=e.data.articles,this.status.listLoading=!1}).catch(e=>{r.fire({title:e.response.data.message,confirmButtonColor:"var(--bs-danger)"}),this.status.listLoading=!1,e.response.status===401&&this.$router.push("/log-in")})},getArticle(l){const e=`${u}/api/${h}/admin/article/${l}`;b.get(e).then(i=>{this.temp=i.data.article,this.enTemp=i.data.article.en,f.show()}).catch(i=>{r.fire({title:i.response.data.message,confirmButtonColor:"var(--bs-danger)"})})},openModal(l,e){l==="new"?(this.isNew=!0,this.temp={create_at:Date.now()},f.show()):l==="edit"?(this.isNew=!1,this.getArticle(e.id)):l==="delete"&&(this.temp={...e},v.show())},updateArticle(){let l=`${u}/api/${h}/admin/article`,e="post";this.isNew||(l=`${u}/api/${h}/admin/article/${this.temp.id}`,e="put"),b[e](l,{data:{...this.temp,en:this.enTemp}}).then(i=>{r.fire({title:i.data.message,icon:"success",confirmButtonColor:"var(--bs-primary)",iconColor:"var(--bs-primary)"}),f.hide(),this.getArticles()}).catch(i=>{r.fire({title:i.response.data.message,confirmButtonColor:"var(--bs-danger)"})})},delArticle(){const l=`${u}/api/${h}/admin/article/${this.temp.id}`;b.delete(l).then(e=>{r.fire({title:e.data.message,icon:"success",confirmButtonColor:"var(--bs-primary)",iconColor:"var(--bs-primary)"}),v.hide(),this.getArticles()}).catch(e=>{r.fire({title:e.data.message,confirmButtonColor:"var(--bs-danger)"})})}},mounted(){this.getArticles(),f=new g(document.getElementById("productModal")),v=new g(document.getElementById("delProductModal"))}},L={class:"row py-3"},U=t("h2",null,"文章列表",-1),I={class:"btn-group mt-3"},E={class:"table table-hover mt-4"},D=t("thead",null,[t("tr",null,[t("th",{width:"120px"},"標題"),t("th",{width:"150px"},"ID"),t("th",{width:"120px"},"是否發佈"),t("th",{width:"120px"},"編輯")])],-1),R={key:0,class:"text-success"},N={key:1},S={class:"btn-group"},F=["onClick"],H=["onClick"],O={key:0,class:"loading"},j=t("div",{class:"spinner-border text-primary",role:"status"},null,-1),Q=[j],q={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},z={class:"modal-dialog modal-xl"},G={class:"modal-content border-0"},J=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"productModalLabel",class:"modal-title"},[t("span",{class:"text-white"},"編輯文章")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),K={class:"modal-body"},W={class:"row"},X={class:"col-sm-4"},Y={class:"mb-3"},Z=t("label",{for:"author",class:"form-label"},"作者",-1),$={class:"mb-2"},tt={class:"mb-3"},et=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),st=["src"],ot={class:"col-sm-8"},lt={class:"mb-3"},it=t("label",{for:"title",class:"form-label"},"標題",-1),nt={class:"row"},at={class:"mb-3 col-md-12"},dt=t("label",{for:"description",class:"form-label"},"簡介",-1),rt={class:"mb-3"},ct=t("label",{for:"content",class:"form-label"},"內容",-1),mt=t("hr",null,null,-1),pt={class:"mb-3"},ut=t("label",{for:"title",class:"form-label"},"Title",-1),ht={class:"mb-3 col-md-12"},bt=t("label",{for:"description",class:"form-label"},"Description",-1),_t={class:"mb-3"},ft=t("label",{for:"content",class:"form-label"},"Content",-1),vt={class:"mb-3"},gt={class:"form-check"},yt=t("label",{class:"form-check-label",for:"isPublic"},"是否發布",-1),xt={class:"modal-footer"},wt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),Ct={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Mt={class:"modal-dialog"},Vt={class:"modal-content border-0"},kt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",{class:"text-white"},"刪除文章")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),At={class:"modal-body"},Tt={class:"text-danger"},Pt={class:"modal-footer"},Bt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Lt(l,e,i,Ut,o,d){const x=M("RouterView");return c(),m(y,null,[t("div",L,[t("div",null,[U,t("div",I,[t("button",{type:"button",class:"btn btn-primary btn-sm",onClick:e[0]||(e[0]=s=>d.openModal("new"))}," 新增文章 ")]),t("table",E,[D,t("tbody",null,[(c(!0),m(y,null,V(o.blogs,s=>(c(),m("tr",{key:s.id},[t("td",null,_(s.title),1),t("td",null,_(s.id),1),t("td",null,[s.isPublic?(c(),m("span",R,"已發佈")):(c(),m("span",N,"未發佈"))]),t("td",null,[t("div",S,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:w=>d.openModal("edit",s)}," 編輯 ",8,F),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:w=>d.openModal("delete",s)}," 刪除 ",8,H)])])]))),128))])]),o.status.listLoading?(c(),m("div",O,Q)):k("",!0),t("p",null,[p("目前有 "),t("span",null,_(o.blogs.length),1),p(" 篇文章")])])]),t("div",q,[t("div",z,[t("div",G,[J,t("div",K,[t("div",W,[t("div",X,[t("div",Y,[Z,n(t("input",{id:"author",type:"text",class:"form-control",placeholder:"請輸入作者","onUpdate:modelValue":e[1]||(e[1]=s=>o.temp.author=s)},null,512),[[a,o.temp.author]])]),t("div",$,[t("div",tt,[et,n(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[2]||(e[2]=s=>o.temp.image=s)},null,512),[[a,o.temp.image]])]),t("img",{class:"img-fluid",src:o.temp.image,alt:"image-preview"},null,8,st)])]),t("div",ot,[t("div",lt,[it,n(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[3]||(e[3]=s=>o.temp.title=s)},null,512),[[a,o.temp.title]])]),t("div",nt,[t("div",at,[dt,n(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入簡介","onUpdate:modelValue":e[4]||(e[4]=s=>o.temp.description=s)},`
                    `,512),[[a,o.temp.description]])])]),t("div",rt,[ct,n(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入文章內容","onUpdate:modelValue":e[5]||(e[5]=s=>o.temp.content=s)},`
                    `,512),[[a,o.temp.content]])]),mt,t("div",pt,[ut,n(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[6]||(e[6]=s=>o.enTemp.title=s)},null,512),[[a,o.enTemp.title]])]),t("div",ht,[bt,n(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入簡介","onUpdate:modelValue":e[7]||(e[7]=s=>o.enTemp.description=s)},`
                    `,512),[[a,o.enTemp.description]])]),t("div",_t,[ft,n(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入文章內容","onUpdate:modelValue":e[8]||(e[8]=s=>o.enTemp.content=s)},`
                    `,512),[[a,o.enTemp.content]])]),t("div",vt,[t("div",gt,[n(t("input",{id:"isPublic",class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,"onUpdate:modelValue":e[9]||(e[9]=s=>o.temp.isPublic=s)},null,512),[[A,o.temp.isPublic]]),yt])])])])]),t("div",xt,[wt,t("button",{type:"button",class:"btn btn-primary",onClick:e[10]||(e[10]=(...s)=>d.updateArticle&&d.updateArticle(...s))}," 確認 ")])])])],512),t("div",Ct,[t("div",Mt,[t("div",Vt,[kt,t("div",At,[p(" 是否刪除 "),t("strong",Tt,_(o.temp.title),1),p(" 商品(刪除後將無法恢復)。 ")]),t("div",Pt,[Bt,t("button",{type:"button",class:"btn btn-danger",onClick:e[11]||(e[11]=(...s)=>d.delArticle&&d.delArticle(...s))}," 確認刪除 ")])])]),p("- ")],512),T(x)],64)}const Rt=C(B,[["render",Lt]]);export{Rt as default};
