import{a as u}from"./axios-G2rPRu76.js";import{_ as w,c,a as t,F as I,g as V,k as m,e as v,t as l,i as x,j as C,d as T,b,w as f,r as L,o as n,p as A,f as E}from"./index-tVg_qlly.js";var S={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"angelalee",BASE_URL:"/hex-vue3-final-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:_,VITE_API_PATH:h}=S,P={data(){return{carts:{},coupon:{code:"",success:!1},status:{addCartLoading:"",removeCartLoading:!1,cartLoading:!1,couponLoading:!1}}},methods:{changeCartQty(s,a=1){const r={product_id:s.product.id,qty:a};u.put(`${_}/api/${h}/cart/${s.id}`,{data:r}).then(()=>{this.getCart()}).catch(g=>{alert(g.response.data.message)})},removeCartItem(s){u.delete(`${_}/api/${h}/cart/${s}`).then(()=>{this.getCart()}).catch(a=>{alert(a.response.data.message)})},removeCartItemAll(){this.status.removeCartLoading=!0,u.delete(`${_}/api/${h}/carts`).then(()=>{this.status.removeCartLoading=!1,this.getCart()}).catch(s=>{this.status.removeCartLoading=!1,alert(s.response.data.message)})},getCart(){this.status.cartLoading=!0,u.get(`${_}/api/${h}/cart`).then(s=>{this.status.cartLoading=!1,console.log(s),this.carts=s.data.data}).catch(s=>{alert(s.response.data.message),this.status.cartLoading=!1})},applyCoupon(s){const a={code:s};this.status.couponLoading=!0,u.post(`${_}/api/${h}/coupon`,{data:a}).then(r=>{this.status.couponLoading=!1,console.log(r),this.coupon.success=r.data.success}).catch(r=>{alert(r.response.data.message),this.status.couponLoading=!1})}},mounted(){this.getCart()}},i=s=>(A("data-v-846101e2"),s=s(),E(),s),R={class:"container"},q={class:"grid"},U={class:"grid-card shopping-cart bg-secondary-subtle"},$=i(()=>t("h2",null,"Shopping Cart",-1)),D={class:"table align-middle",style:{"--bs-table-bg":"transparent","--bs-table-color":"$primary"}},O=i(()=>t("thead",null,[t("tr",null,[t("th",{width:"50",class:"text-center"},"Item"),t("th",{width:"80",class:"text-center"}),t("th",{width:"50",class:"text-center"},"Price"),t("th",{width:"100",class:"text-center"},"Quantity"),t("th",{width:"50",class:"text-center"},"Total"),t("th",{width:"50",class:"text-center"})])],-1)),B={class:"table-img"},N=["src"],Q={class:"table-item"},H={class:"table-price text-end"},M={class:"table-qty text-center"},j={class:"input-group"},F=["onClick","disabled"],z=["onUpdate:modelValue"],W=["onClick"],G={class:"table-final-price text-end"},J={class:"table-delete-btn text-center",style:{"font-size":"1.5em"}},K={type:"button",style:{border:"none","border-radius":"100%","background-color":"transparent"}},X=["onClick"],Y={key:0,class:"loading"},Z=i(()=>t("div",{class:"spinner-border text-primary",role:"status"},null,-1)),tt=[Z],et=["disabled"],st={key:0,class:"spinner-border text-cus-cream",style:{width:"1.2em",height:"1.2em"},role:"status"},ot={class:"grid-card order-summary bg-primary"},at={class:"order-summary-content"},ct=i(()=>t("h2",{class:"text-cus-cream"},"Order Summary",-1)),nt={class:"row row-cols-2"},rt=i(()=>t("div",{class:"col-6 mt-4 text-cus-cream"},"Subtotal:",-1)),it={class:"col-6 mt-4 text-cus-cream text-end"},dt={class:"col-12 mt-4 text-cus-cream input-group"},lt=["disabled"],ut={key:0,class:"spinner-border text-cus-cream",style:{width:"1.2em",height:"1.2em"},role:"status"},_t={class:"col-12 mt-4"},ht={key:0,class:"text-cus-cream"},pt=i(()=>t("div",{class:"col-6 mt-4 text-cus-cream fs-5 fw-semibold"},"Total:",-1)),mt={class:"col-6 mt-4 text-end fs-5 fw-semibold"},bt={key:0,class:"text-cus-cream"},gt={key:1,class:"text-cus-cream"},yt={class:"col-12 mt-4"},vt=i(()=>t("button",{type:"button",class:"btn btn-cus-cream text-primary"}," Proceed to Checkout ",-1));function xt(s,a,r,g,o,d){const y=L("RouterLink"),k=L("RouterView");return n(),c("div",R,[t("div",q,[t("div",U,[$,t("table",D,[O,t("tbody",null,[(n(!0),c(I,null,V(o.carts.carts,e=>(n(),c("tr",{key:e.id},[t("td",B,[t("img",{src:e.product.imageUrl,alt:"",style:{width:"100%"}},null,8,N)]),t("td",Q,[b(y,{to:`/product/${e.product.id}`},{default:f(()=>[t("span",null,l(e.product.title),1)]),_:2},1032,["to"])]),t("td",H,"$"+l(e.product.price),1),t("td",M,[t("div",j,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:p=>{e.qty--,d.changeCartQty(e,e.qty)},disabled:e.qty===1}," - ",8,F),x(t("input",{type:"number",class:"form-control text-center","onUpdate:modelValue":p=>e.qty=p,readonly:""},null,8,z),[[C,e.qty]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:p=>{e.qty++,d.changeCartQty(e,e.qty)}}," + ",8,W)])]),t("td",G,[t("span",null,"$"+l(e.total),1)]),t("td",J,[t("button",K,[t("i",{class:"bi bi-x",onClick:p=>d.removeCartItem(e.id)},null,8,X)])])]))),128))])]),o.status.cartLoading?(n(),c("div",Y,tt)):m("",!0),t("button",{type:"button",class:"btn btn-primary text-cus-cream",onClick:a[0]||(a[0]=(...e)=>d.removeCartItemAll&&d.removeCartItemAll(...e)),disabled:o.status.removeCartLoading},[o.status.removeCartLoading?(n(),c("i",st)):m("",!0),v(" 清空購物車")],8,et)]),t("div",ot,[t("div",at,[ct,t("div",nt,[rt,t("div",it,"$ "+l(o.carts.total),1),t("div",dt,[x(t("input",{type:"text",class:"form-control",placeholder:"Enter SWEETTOOTH2024","aria-describedby":"button-addon2","onUpdate:modelValue":a[1]||(a[1]=e=>o.coupon.code=e)},null,512),[[C,o.coupon.code]]),t("button",{class:"btn btn-secondary text-cus-cream",type:"button",id:"button-addon2",onClick:a[2]||(a[2]=T(e=>d.applyCoupon(o.coupon.code),["prevent"])),disabled:o.status.couponLoading},[o.status.couponLoading?(n(),c("i",ut)):m("",!0),v(" Apply ")],8,lt)]),t("div",_t,[o.coupon.success?(n(),c("p",ht,"已套用優惠券！")):m("",!0)]),pt,t("div",mt,[o.coupon.success?(n(),c("span",bt,"$ "+l(o.carts.final_total),1)):(n(),c("span",gt,"$ "+l(o.carts.total),1))])])]),t("div",yt,[b(y,{to:"/checkout"},{default:f(()=>[vt]),_:1})])])]),b(k)])}const Lt=w(P,[["render",xt],["__scopeId","data-v-846101e2"]]);export{Lt as default};
