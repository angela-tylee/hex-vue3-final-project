import{a as m,S as u}from"./sweetalert2.all-3NlZ93nL.js";import{M as x}from"./bootstrap.esm-TTjMTX3M.js";import{_ as v,r as y,o as a,c as d,b as t,F as h,i as p,f as w,g as n,t as s,d as P}from"./index-r2JnNlAo.js";var V={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"angelalee",BASE_URL:"/hex-vue3-final-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:b,VITE_API_PATH:g}=V;let _="";const k={data(){return{orders:[],temp:{},isNew:!1,status:{listLoading:!1},form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getOrders(){this.status.listLoading=!0,m.get(`${b}/api/${g}/admin/orders`).then(o=>{this.orders=o.data.orders,this.status.listLoading=!1}).catch(o=>{u.fire({title:o.response.data.message,confirmButtonColor:"var(--bs-danger)"}),this.status.listLoading=!1,o.response.status===401&&this.$router.push("/log-in")})},openModal(o,l){o==="delete"&&(this.temp={...l},_.show())},delOrder(){const o=`${b}/api/${g}/admin/order/${this.temp.id}`;m.delete(o).then(l=>{u.fire({title:l.data.message,icon:"success",confirmButtonColor:"var(--bs-primary)",iconColor:"var(--bs-primary)"}),_.hide(),this.getOrders()}).catch(l=>{u.fire({title:l.data.message,confirmButtonColor:"var(--bs-danger)"})})}},mounted(){this.getOrders(),_=new x(document.getElementById("delProductModal"))}},L={class:"row py-3 list-container"},M=t("h2",null,"訂單列表",-1),C={class:"table table-hover mt-4"},E=t("thead",null,[t("tr",null,[t("th",{width:"120px"},"訂單編號"),t("th",{width:"100px"},"姓名"),t("th",{width:"150px"},"品項"),t("th",{width:"100px"},"金額"),t("th",{width:"120px"},"Email / 電話"),t("th",{width:"150px"},"地址"),t("th",{width:"150px"},"付款狀態"),t("th",{width:"100px"},"編輯")])],-1),O=t("br",null,null,-1),I={key:0,class:"text-success"},B={key:1,class:"text-danger"},A={class:"btn-group"},R=["onClick"],T={key:0,class:"loading"},S=t("div",{class:"spinner-border text-primary",role:"status"},null,-1),N=[S],$={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},D={class:"modal-dialog"},U={class:"modal-content border-0"},F=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",{class:"text-white"},"刪除訂單")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),H={class:"modal-body"},j={class:"text-danger"},q={class:"modal-footer"},z=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function G(o,l,J,K,i,c){const f=y("RouterView");return a(),d(h,null,[t("div",L,[t("div",null,[M,t("table",C,[E,t("tbody",null,[(a(!0),d(h,null,p(i.orders,e=>(a(),d("tr",{key:e.id},[t("td",null,s(e.id),1),t("td",null,s(e.user.name),1),t("td",null,[(a(!0),d(h,null,p(e.products,r=>(a(),d("div",{class:"text-black",key:r.id},s(r.product.title)+" x "+s(r.qty),1))),128))]),t("td",null,"$ "+s(e.total),1),t("td",null,[n(s(e.user.email),1),O,n(s(e.user.tel),1)]),t("td",null,s(e.user.address),1),e.is_paid?(a(),d("td",I,"已付款")):(a(),d("td",B,"未付款")),t("td",null,[t("div",A,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:r=>c.openModal("delete",e)}," 刪除 ",8,R)])])]))),128))])]),i.status.listLoading?(a(),d("div",T,N)):w("",!0),t("p",null,[n("目前有 "),t("span",null,s(i.orders.length),1),n(" 項產品")])])]),t("div",$,[t("div",D,[t("div",U,[F,t("div",H,[n(" 是否刪除 "),t("strong",j,s(i.temp.title),1),n(" 訂單(刪除後將無法恢復)。 ")]),t("div",q,[z,t("button",{type:"button",class:"btn btn-danger",onClick:l[0]||(l[0]=(...e)=>c.delOrder&&c.delOrder(...e))}," 確認刪除 ")])])]),n("- ")],512),P(f)],64)}const Y=v(k,[["render",G]]);export{Y as default};
